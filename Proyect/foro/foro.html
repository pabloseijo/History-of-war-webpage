<!DOCTYPE html>
<html>

<head lang="es">
    <script src="https://kit.fontawesome.com/1415b55916.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="./foro.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.7/css/all.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FORO HISTORICO</title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script>
        $(document).ready(function () {
            $("#btn_mostrar").click(function () {
                // Oculta el botón al hacer clic
                $("#btn_mostrar").css('display', 'none');

                // Realiza una solicitud AJAX para cargar el contenido XML
                $.ajax({
                    type: "GET",
                    url: "demo_test.xml",
                    dataType: "xml",
                    success: function (xml) {
                        // Procesa el XML y agrega los elementos al div contenedor
                        procesarXML(xml);
                    },
                    error: function (xhr, status, error) {
                        console.error("Error al cargar el archivo XML:", error);
                    }
                });
            });

            function procesarXML(xml) {
                // Encuentra los posts en el XML
                $(xml).find('post').each(function () {
                    var postId = $(this).attr('id');
                    var imagenSrc = $(this).find('imagen').attr('src');
                    var titulo = $(this).find('titulo').text();
                    var autor = $(this).find('autor').text();
                    var texto = $(this).find('texto').text();

                    // Crea un nuevo elemento HTML para el post
                    var postDiv = $('<div class="post" id="' + postId + '">');
                    postDiv.append('<img class="img_post" src="' + imagenSrc + '">');
                    postDiv.append('<h2 class="titulo">' + titulo + '</h2>');
                    postDiv.append('<div class="info"><img class="pfp" src="../Images/pfp.png" width="50px" height="50px"><p class="autor">' + autor + '</p></div>');
                    postDiv.append('<p class="texto oculto">' + texto + '</p>');
                    postDiv.append('<button class="mostrar-descripcion"><i class="fas fa-plus"></i></button>');

                    // Agrega el post al div contenedor
                    $('#fill_data').append(postDiv);
                });
            }
            $('#input_txt').click(() => $('#input_txt').val(""));
            $('#input_titulo').click(() => $('#input_titulo').val(""));

            $('#miForm').submit(function (event) {
                // Evitar el envío del formulario predeterminado
                event.preventDefault();

                // Obtener el valor del campo de texto
                let texto = $('#input_txt').val();

                let titulo = $('#input_titulo').val();

                // Obtener el archivo cargado
                let archivo = $('#myfile')[0].files[0];

                // Crear un nuevo elemento div con la clase "post"
                let nuevoPost = $('<div class="post"></div>');

                // Crear un elemento img para la imagen del post
                let nuevaImagen = $('<img class="img_post">');
                if (archivo != null) nuevaImagen.attr('src', URL.createObjectURL(archivo));

                // Crear un elemento p para el texto del post
                let nuevoParrafo = $('<p class="texto oculto"></p>');
                nuevoParrafo.text(texto);

                let nuevoTitulo = $('<h2 class="titulo"></h2>');
                nuevoTitulo.text(titulo);

                // Crear un botón para mostrar la descripción
                let botonMostrar = $('<button class="mostrar-descripcion"><i class="fas fa-plus"></i></button>');

                // Crear un botón para eliminar el post
                let botonEliminar = $('<button class="eliminar-post"><i class="fas fa-trash"></i></button>');

                botonEliminar.addClass('boton-eliminar');

                // Añadir la imagen, el texto y los botones al nuevo elemento "post"
                nuevoPost.append(nuevaImagen);
                nuevoPost.append(nuevoTitulo);
                nuevoPost.append('<div class="info"><img class="pfp" src="../Images/pfp.png" width="50px" height="50px"><p class="autor">GUEST</p></div>');
                nuevoPost.append(nuevoParrafo);
                nuevoPost.append(botonMostrar);
                nuevoPost.append(botonEliminar);

                // Añadir el nuevo elemento "post" al documento
                $('.formulario').before(nuevoPost);

                // Limpiar el formulario después de enviar
                $('#miForm')[0].reset();
            });

            // Evento de clic para eliminar un post
            $(document).on('click', '.eliminar-post', function () {
                $(this).closest('.post').remove(); // Elimina el post más cercano al botón clickeado
            });
            // Evento de clic para mostrar la descripción
            $(document).on('click', '.mostrar-descripcion', function () {
                let texto = $(this).find('i');
                $(this).prev('.texto').toggleClass('oculto');
                if ($(this).prev('.texto').hasClass('oculto')) {
                    texto.removeClass('fa-minus').addClass('fa-plus');
                } else {
                    texto.removeClass('fa-plus').addClass('fa-minus');
                }
            });

            // Evento de clic para mostrar la imagen ampliada
            $('.img_post, .pfp').click(function () {
                var src = $(this).attr('src');
                $('#imagenAmpliadaContenido').attr('src', src);
                $('#imagenAmpliada').fadeIn();
            });

            // Evento de clic para ocultar la imagen ampliada
            $('#imagenAmpliada').click(function () {
                $(this).fadeOut();
            });

            $('.lista_nav li a').mouseover(function () {
                $(this).find('i').css('visibility', 'visible');
            });

            $('.lista_nav li a').mouseout(function () {
                $(this).find('i').css('visibility', 'hidden');
            });
        });
    </script>
</head>

<body>
    <header class="header">

        <a href="../index.html">
            <img class="headerImg" src="../Images/coin128.png" alt="Logo" width="100" height="100">
        </a>

        <div class="header-group"> <!-- Contenedor para el título y el menú -->
            <span class="header-title">HISTORY OF WAR</span>
            <nav class="header-menu">
                <ul class="header-list">
                    <li class="header-menu-item"> <a href="../Mapa/mapa.html"> Mapa </a> </li>
                    <li class="header-menu-item"> <a href="../AcontecimientosHistoricos/AH.html"> Acontecimientos
                            Históricos </a> </li>
                    <li class="header-menu-item"> <a href="../biblioteca/biblioteca.html"> Biblioteca </a> </li>
                    <li class="header-menu-item"> <a href="../foro/foro.html"> Foro </a> </li>
                    <li class="header-menu-item"> <a href="../buscador/buscador.html"> Buscador </a> </li>
                    <li class="header-menu-item"> <a href="../login/login.html"> Iniciar Sesión </a> </li>
                </ul>
                <a href="javascript:void(0);" class="icon" onclick="myFunction()">
                    <i class="fa fa-bars"></i>
                </a>
            </nav>
        </div>

    </header>
    <div class="principal">
        <aside>
            <h3 class="titulo_nav">TRENDING POSTS <i class="fa-solid fa-fire"></i></h3>
            <nav class="nav_posts">
                <ul class="lista_nav">
                    <li><a href="#post1"><i class="fa-solid fa-arrow-right"></i>Meme Monday</a></li>
                    <li><a href="#post2"><i class="fa-solid fa-arrow-right"></i>Niggas in da hood</a></li>
                </ul>
            </nav>
        </aside>

        <main>
            <button id="btn_mostrar" type="button">Mostar nuevos posts</button>
            <div id="fill_data">

            </div>
            <div class="post" id="post1">
                <img class="img_post" src="../Images/batallaCannas.png">
                <h2 class="titulo">Meme Monday</h2>
                <div class="info">
                    <img class="pfp" src="../Images/pfp_user1.jpg" width="50px" height="50px">
                    <p class="autor">AUTOR</p>
                </div>
                <p class="texto oculto">Lorem, ipsum dolor sit amet consectetur adipisicing elit. Dolorem doloremque
                    impedit
                    delectus. Optio voluptate est velit eligendi aperiam dolorem quos nobis aspernatur numquam, aliquam
                    voluptatum minima ipsum tempore repellendus? Quia!</p>
                <button class="mostrar-descripcion"><i class="fas fa-plus"></i></button>

            </div>

            <div class="post" id="post2">
                <img class="img_post" src="../Images/guerrasNapoleonicas.png">
                <h2 class="titulo">Niggas in da hood</h2>
                <div class="info">
                    <img class="pfp" src="../Images/pfp_user2.jpg" width="50px" height="50px">
                    <p class="autor">Mohhamed abdul nigger</p>
                </div>
                <p class="texto oculto">Lorem ipsum dolor sit amet consectetur adipisicing elit. Illo ducimus eius nihil
                    minima accusamus! Tenetur optio maxime harum doloremque possimus necessitatibus nostrum totam dolor
                    dolorum. Aliquam blanditiis aspernatur voluptatibus dignissimos.Lorem ipsum dolor sit amet
                    consectetur adipisicing elit. Illo ducimus eius nihil
                    minima accusamus! Tenetur optio maxime harum doloremque possimus necessitatibus nostrum totam dolor
                    dolorum. Aliquam blanditiis aspernatur voluptatibus dignissimos.</p>
                <button class="mostrar-descripcion"><i class="fas fa-plus"></i></button>
            </div>
            <div class="formulario">
                <form id="miForm">
                    <input type="text" id="input_titulo" value="Titulo de tu idea">
                    <input type="text" id="input_txt" value="Comparte tu idea">
                    <input type="submit" id="submit" value="Submit">
                    <input type="file" id="myfile" name="myfile">
                </form>
            </div>

            <!-- Div para mostrar la imagen ampliada -->
            <div id="imagenAmpliada">
                <img id="imagenAmpliadaContenido" src="" alt="Imagen Ampliada">
            </div>
        </main>
        <footer class="footer">
            <ul class="footer-menu">
                <li class="footer-list-item"> <a href="../index.html"> Home </a> </li>
                <li class="footer-list-item"> <a href="../contacto.html"> Contacto </a> </li>
                <li class="footer-list-item"> <a href="../sobrenosotros.html"> Sobre Nosotros </a> </li>
                <li class="footer-list-item"> <a href=""> <i class="fa-brands fa-instagram"></i> </a> </li>
                <li class="footer-list-item"> <a href=""> <i class="fa-brands fa-x-twitter"></i> </a> </li>
                <li class="footer-list-item"> <a href=""> <i class="fa-brands fa-facebook"></i> </a> </li>
            </ul>
        </footer>
    </div>
    <script src="../header.js"></script>
</body>

</html>